<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="21,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="mxinfo " id="T1:U1"><span class="var type1" id="S2T1U3"><span class="message error" id="M9F45C">c</span></span></span> = ReqFuncSolver(<span class="var type1" id="S3T1U6">R</span>, <span class="var type1" id="S4T1U7">kdi</span>, <span class="var type1" id="S5T1U8">Li</span>, <span class="var type1" id="S6T1U9">vi</span>, <span class="var type1" id="S7T1U10">kx</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="21,2" id="srcline2"> 2</a></span><span class="line">    <span class="comment">%%%This function returns the point at which function fun equals zero</span></span></span>
<span class="srcline"><span class="lineno"><a href="21,3" id="srcline3"> 3</a></span><span class="line">    <span class="comment">%%%using the bisection algorithm. The closest a and b will converge to</span></span></span>
<span class="srcline"><span class="lineno"><a href="21,4" id="srcline4"> 4</a></span><span class="line">    <span class="comment">%%%in the algorithm is a distance 1e-12 apart.</span></span></span>
<span class="srcline"><span class="lineno"><a href="21,5" id="srcline5"> 5</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="21,6" id="srcline6"> 6</a></span><span class="line">    <span class="mxinfo " id="T1:U7"><span class="var type1" id="S8T1U13">a</span> = <span class="mxinfo " id="T1:U9">-20</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="21,7" id="srcline7"> 7</a></span><span class="line">    <span class="mxinfo " id="T1:U10"><span class="var type1" id="S9T1U18">b</span> = <span class="mxinfo " id="T1:U12">log10(<span class="var type1" id="S3T1U21">R</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="21,8" id="srcline8"> 8</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="21,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo " id="T1:U14"><span class="var type1" id="S11T1U24">bVal</span> = <span class="mxinfo " id="T1:U16"><span class="fcn" id="F59N5:B26">fun</span>(<span class="var type1" id="S9T1U27">b</span>, <span class="var type1" id="S3T1U28">R</span>, <span class="var type1" id="S4T1U29">kdi</span>, <span class="var type1" id="S5T1U30">Li</span>, <span class="var type1" id="S6T1U31">vi</span>, <span class="var type1" id="S7T1U32">kx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="21,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo " id="T1:U23"><span class="var type1" id="S13T1U35">cVal</span> = <span class="mxinfo " id="T1:U25"><span class="fcn" id="F70N5:B37">fun</span>(<span class="var type1" id="S8T1U38">a</span>, <span class="var type1" id="S3T1U39">R</span>, <span class="var type1" id="S4T1U40">kdi</span>, <span class="var type1" id="S5T1U41">Li</span>, <span class="var type1" id="S6T1U42">vi</span>, <span class="var type1" id="S7T1U43">kx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="21,11" id="srcline11">11</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="21,12" id="srcline12">12</a></span><span class="line">    <span class="comment">% Is there no root within the interval?</span></span></span>
<span class="srcline"><span class="lineno"><a href="21,13" id="srcline13">13</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T9:U32"><span class="mxinfo " id="T1:U33"><span class="var type1" id="S11T1U48">bVal</span>*<span class="var type1" id="S13T1U49">cVal</span></span> &gt; <span class="mxinfo " id="T1:U36">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="21,14" id="srcline14">14</a></span><span class="line">        <span class="mxinfo " id="T1:U37"><span class="var type1" id="S2T1U53">c</span> = <span class="mxinfo " id="T1:U39">1000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="21,15" id="srcline15">15</a></span><span class="line">        <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="21,16" id="srcline16">16</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="21,17" id="srcline17">17</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="21,18" id="srcline18">18</a></span><span class="line">    <span class="comment">%Commence algorithm</span></span></span>
<span class="srcline"><span class="lineno"><a href="21,19" id="srcline19">19</a></span><span class="line">    <span class="keyword">while</span> <span class="mxinfo " id="T9:U40"><span class="mxinfo " id="T1:U41"><span class="var type1" id="S9T1U60">b</span> - <span class="var type1" id="S8T1U61">a</span></span> &gt; <span class="mxinfo " id="T1:U44">1e-4</span></span> || <span class="mxinfo " id="T9:U45"><span class="mxinfo " id="T1:U46">abs(<span class="var type1" id="S13T1U66">cVal</span>)</span> &gt; <span class="mxinfo " id="T1:U48">1E-4</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="21,20" id="srcline20">20</a></span><span class="line">        <span class="mxinfo " id="T1:U49"><span class="var type1" id="S2T1U70">c</span> = <span class="mxinfo " id="T1:U51">(<span class="mxinfo " id="T1:U52"><span class="var type1" id="S8T1U74">a</span>+<span class="var type1" id="S9T1U75">b</span></span>)/<span class="mxinfo " id="T1:U55">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="21,21" id="srcline21">21</a></span><span class="line">        <span class="mxinfo " id="T1:U56"><span class="var type1" id="S13T1U79">cVal</span> = <span class="mxinfo " id="T1:U58"><span class="fcn" id="F59N5:B81">fun</span>(<span class="var type1" id="S2T1U82">c</span>, <span class="var type1" id="S3T1U83">R</span>, <span class="var type1" id="S4T1U84">kdi</span>, <span class="var type1" id="S5T1U85">Li</span>, <span class="var type1" id="S6T1U86">vi</span>, <span class="var type1" id="S7T1U87">kx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="21,22" id="srcline22">22</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="21,23" id="srcline23">23</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T9:U65"><span class="mxinfo " id="T1:U66"><span class="var type1" id="S13T1U92">cVal</span>*<span class="var type1" id="S11T1U93">bVal</span></span> &gt;= <span class="mxinfo " id="T1:U69">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="21,24" id="srcline24">24</a></span><span class="line">            <span class="mxinfo " id="T1:U70"><span class="var type1" id="S9T1U97">b</span> = <span class="var type1" id="S2T1U98">c</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="21,25" id="srcline25">25</a></span><span class="line">            <span class="mxinfo " id="T1:U73"><span class="var type1" id="S11T1U101">bVal</span> = <span class="var type1" id="S13T1U102">cVal</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="21,26" id="srcline26">26</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="21,27" id="srcline27">27</a></span><span class="line">            <span class="mxinfo " id="T1:U76"><span class="var type1" id="S8T1U106">a</span> = <span class="var type1" id="S2T1U107">c</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="21,28" id="srcline28">28</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="21,29" id="srcline29">29</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="21,30" id="srcline30">30</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="21,31" id="srcline31">31</a></span><span class="line"><span class="comment">%-------------------------------------------------------------------------</span></span></span>
</pre>
